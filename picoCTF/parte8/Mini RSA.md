### Mini RSA
## Objetivo
What happens if you have a small exponent? There is a twist though, we padded the plaintext so that (M ** e) is just barely larger than N. Let's decrypt this: [ciphertext](https://mercury.picoctf.net/static/a9d46a88f2602fa48edf086a5afbfed8/ciphertext)
## Hints
1. RSA [tutorial](https://en.wikipedia.org/wiki/RSA_(cryptosystem))
2. How could having too small of an `e` affect the security of this key?
3. Make sure you don't lose precision, the numbers are pretty big (besides the `e` value)
4. You shouldn't have to make _too_ many guesses
5. `pico` is in the flag, but not at the beginning
## Datos de acceso al nivel
## Solución
c = m^e mod n
c = m ^ 3
m = 3 raíz c

```bash
┌──(kali㉿kali)-[~/SEGURIDAD7A]
└─$ wget https://mercury.picoctf.net/static/a9d46a88f2602fa48edf086a5afbfed8/ciphertext
--2023-11-14 20:28:54--  https://mercury.picoctf.net/static/a9d46a88f2602fa48edf086a5afbfed8/ciphertext
Resolving mercury.picoctf.net (mercury.picoctf.net)... 18.189.209.142
Connecting to mercury.picoctf.net (mercury.picoctf.net)|18.189.209.142|:443... connected.
HTTP request sent, awaiting response... 200 OK
Length: 2039 (2.0K) [application/octet-stream]
Saving to: ‘ciphertext’

ciphertext                    100%[===============================================>]   1.99K  --.-KB/s    in 0.008s  

2023-11-14 20:28:55 (264 KB/s) - ‘ciphertext’ saved [2039/2039]

                                                                                                                      
┌──(kali㉿kali)-[~/SEGURIDAD7A]
└─$ cat ciphertext     
N: 1615765684321463054078226051959887884233678317734892901740763321135213636796075462401950274602405095138589898087428337758445013281488966866073355710771864671726991918706558071231266976427184673800225254531695928541272546385146495736420261815693810544589811104967829354461491178200126099661909654163542661541699404839644035177445092988952614918424317082380174383819025585076206641993479326576180793544321194357018916215113009742654408597083724508169216182008449693917227497813165444372201517541788989925461711067825681947947471001390843774746442699739386923285801022685451221261010798837646928092277556198145662924691803032880040492762442561497760689933601781401617086600593482127465655390841361154025890679757514060456103104199255917164678161972735858939464790960448345988941481499050248673128656508055285037090026439683847266536283160142071643015434813473463469733112182328678706702116054036618277506997666534567846763938692335069955755244438415377933440029498378955355877502743215305768814857864433151287
e: 3

ciphertext (c): 1220012318588871886132524757898884422174534558055593713309088304910273991073554732659977133980685370899257850121970812405700793710546674062154237544840177616746805668666317481140872605653768484867292138139949076102907399831998827567645230986345455915692863094364797526497302082734955903755050638155202890599808154558034707767377524500302754459807923331810585173010977657982069888996945830789092526932364658459034145456505057469113036134559745659079236466119515004648189278227777550415021840140147319061470183840214034417917161940379351273394212022847037696265532968684592354941479799473941357715953204487236888712642494877545201005807776354854390358015733495331101077851132489983665939643188064986446883595239842621440918456201787168234988410659153219277329426230136499096098072681939491840913961290536851217677043565743644469862992310241563891464225935615676242084658617931225618537173689559419607688905143683603007487996422560430269750305079282818976557285786253025774883158125978164878245223052992502106
                                                                                                                      
┌──(kali㉿kali)-[~/SEGURIDAD7A]
└─$ sudo python3 -m pip install gmpy2
[sudo] password for kali: 
Collecting gmpy2
  Downloading gmpy2-2.1.5-cp311-cp311-manylinux_2_17_x86_64.manylinux2014_x86_64.whl (1.8 MB)
     ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 1.8/1.8 MB 1.8 MB/s eta 0:00:00
Installing collected packages: gmpy2
Successfully installed gmpy2-2.1.5
WARNING: Running pip as the 'root' user can result in broken permissions and conflicting behaviour with the system package manager. It is recommended to use a virtual environment instead: https://pip.pypa.io/warnings/venv               
                                                                                                                      
┌──(kali㉿kali)-[~/SEGURIDAD7A]
└─$ sudo python3 -m pip install pycryptodome
Collecting pycryptodome
  Obtaining dependency information for pycryptodome from https://files.pythonhosted.org/packages/00/e6/73931df4046e34a6354d323b4a5b5c18e5184f4a08687806ee3353c81a6b/pycryptodome-3.19.0-cp35-abi3-manylinux_2_17_x86_64.manylinux2014_x86_64.whl.metadata
  Downloading pycryptodome-3.19.0-cp35-abi3-manylinux_2_17_x86_64.manylinux2014_x86_64.whl.metadata (3.4 kB)
Downloading pycryptodome-3.19.0-cp35-abi3-manylinux_2_17_x86_64.manylinux2014_x86_64.whl (2.1 MB)
   ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 2.1/2.1 MB 2.6 MB/s eta 0:00:00
Installing collected packages: pycryptodome
Successfully installed pycryptodome-3.19.0
WARNING: Running pip as the 'root' user can result in broken permissions and conflicting behaviour with the system package manager. It is recommended to use a virtual environment instead: https://pip.pypa.io/warnings/venv 
```

```bash
┌──(kali㉿kali)-[~]
└─$ python3
Python 3.11.5 (main, Aug 29 2023, 15:31:31) [GCC 13.2.0] on linux
Type "help", "copyright", "credits" or "license" for more information.
>>> from gmpy2 import *
>>> from Crypto.Util.number import long_to_bytes
>>> 
>>> gmpy2.get_context().precision=2048
>>> 
>>> e = 3
>>> c = 1220012318588871886132524757898884422174534558055593713309088304910273991073554732659977133980685370899257850121970812405700793710546674062154237544840177616746805668666317481140872605653768484867292138139949076102907399831998827567645230986345455915692863094364797526497302082734955903755050638155202890599808154558034707767377524500302754459807923331810585173010977657982069888996945830789092526932364658459034145456505057469113036134559745659079236466119515004648189278227777550415021840140147319061470183840214034417917161940379351273394212022847037696265532968684592354941479799473941357715953204487236888712642494877545201005807776354854390358015733495331101077851132489983665939643188064986446883595239842621440918456201787168234988410659153219277329426230136499096098072681939491840913961290536851217677043565743644469862992310241563891464225935615676242084658617931225618537173689559419607688905143683603007487996422560430269750305079282818976557285786253025774883158125978164878245223052992502106
>>> 
>>> root, exact = iroot(c, e) 
>>> root
mpz(106853332652432478823479268251952762332539847111872583298926285910844066620524275860449200877961470156007933663569740467088542775307801035926875522276491129471033754427069136664680585101128413760373262347104521736750958041229560781277160132457139060114077575090698553884062695463643144131656598068508777247965321021827314942795467619196)
>>> print( long_to_bytes(root) )
b'picoCTF{n33d_a_lArg3r_e_606ce004}
```

```

```
```bash
┌──(kali㉿kali)-[~]
└─$ wget https://jupiter.challenges.picoctf.org/static/ee7e2388b45f521b285334abb5a63771/ciphertext
--2023-11-15 02:46:50--  https://jupiter.challenges.picoctf.org/static/ee7e2388b45f521b285334abb5a63771/ciphertext
Resolving jupiter.challenges.picoctf.org (jupiter.challenges.picoctf.org)... 3.131.60.8
Connecting to jupiter.challenges.picoctf.org (jupiter.challenges.picoctf.org)|3.131.60.8|:443... connected.
HTTP request sent, awaiting response... 200 OK
Length: 884 [application/octet-stream]
Saving to: ‘ciphertext’

ciphertext                   100%[============================================>]     884  --.-KB/s    in 0s      

2023-11-15 02:46:50 (4.97 MB/s) - ‘ciphertext’ saved [884/884]

                                                                                                                  
┌──(kali㉿kali)-[~]
└─$ cat ciphertext     

N: 29331922499794985782735976045591164936683059380558950386560160105740343201513369939006307531165922708949619162698623675349030430859547825708994708321803705309459438099340427770580064400911431856656901982789948285309956111848686906152664473350940486507451771223435835260168971210087470894448460745593956840586530527915802541450092946574694809584880896601317519794442862977471129319781313161842056501715040555964011899589002863730868679527184420789010551475067862907739054966183120621407246398518098981106431219207697870293412176440482900183550467375190239898455201170831410460483829448603477361305838743852756938687673
e: 3

ciphertext (c): 2205316413931134031074603746928247799030155221252519872649649212867614751848436763801274360463406171277838056821437115883619169702963504606017565783537203207707757768473109845162808575425972525116337319108047893250549462147185741761825125 
                                                                                                                  
┌──(kali㉿kali)-[~]
└─$ python
Python 3.11.5 (main, Aug 29 2023, 15:31:31) [GCC 13.2.0] on linux
Type "help", "copyright", "credits" or "license" for more information.
>>> from gmpy2 import *
>>> 
>>> gmpy2.get_context().precision = 2048
>>> 
>>> n = 29331922499794985782735976045591164936683059380558950386560160105740343201513369939006307531165922708949619162698623675349030430859547825708994708321803705309459438099340427770580064400911431856656901982789948285309956111848686906152664473350940486507451771223435835260168971210087470894448460745593956840586530527915802541450092946574694809584880896601317519794442862977471129319781313161842056501715040555964011899589002863730868679527184420789010551475067862907739054966183120621407246398518098981106431219207697870293412176440482900183550467375190239898455201170831410460483829448603477361305838743852756938687673
>>> e = 3
>>> c = 2205316413931134031074603746928247799030155221252519872649649212867614751848436763801274360463406171277838056821437115883619169702963504606017565783537203207707757768473109845162808575425972525116337319108047893250549462147185741761825125
>>> 
>>> for t in range(10000):
...     m, r = iroot(t*n + c , e)
...     if r :
...         print('Encontre t : ' + str(t))
...         print('Flag       : ' + str(bytes.fromhex(hex(m)[2:]).decode()))
... 
Encontre t : 0
Flag       : picoCTF{n33d_a_lArg3r_e_606ce004}
>>> 

```
## Notas adicionales
c - texto cifrado
m - 
p - 
q - 
n - 
tn - 
e - 
d - 

n = p * q
tn = (p-1) * (q-1)
d = e mod inv tn    /  inverse(e,tn)

Encriptar      | : c = m^e mod n        / pow(m,e,n)

Desencriptar  : m = c^d mod n       /pow(c,d,n)s

sudo python3 -m pip install gmpy2 --> librería de pyhton  para manejar números de alta precisión en rsa.
sudo python3 -m pip install pycryptodome --> biblioteca de criptografía para python3.
## Referencias
[RSA (cryptosystem) - Wikipedia](https://en.wikipedia.org/wiki/RSA_(cryptosystem))